"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdateacfun_evolved"]("AcFun_Evolved",{

/***/ "./src/core/api/PluginToolkit.ts":
/*!***************************************!*\
  !*** ./src/core/api/PluginToolkit.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Preferences__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Preferences */ \"./src/core/api/Preferences.ts\");\n/* harmony import */ var _Security__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Security */ \"./src/core/api/Security.ts\");\n/* harmony import */ var _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/ACEV2Toast */ \"./src/plugins/ACEV2Toast.ts\");\n/* harmony import */ var _plugins_ACEV2Dialog__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugins/ACEV2Dialog */ \"./src/plugins/ACEV2Dialog.ts\");\n/* harmony import */ var _I18n__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./I18n */ \"./src/core/api/I18n.ts\");\n/* harmony import */ var _services_ACEV2Storage__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../services/ACEV2Storage */ \"./src/core/services/ACEV2Storage.ts\");\n/* harmony import */ var _plugins_ACEV2Loader__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugins/ACEV2Loader */ \"./src/plugins/ACEV2Loader.ts\");\n/* harmony import */ var _Logger__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./Logger */ \"./src/core/api/Logger.ts\");\n/* harmony import */ var _ACEV2URL__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ACEV2URL */ \"./src/core/api/ACEV2URL.ts\");\n/* harmony import */ var _Supervisor__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./Supervisor */ \"./src/core/api/Supervisor.ts\");\n/* harmony import */ var _plugins_PluginStore__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../plugins/PluginStore */ \"./src/plugins/PluginStore.ts\");\n/* harmony import */ var _plugins_DebugBridge__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../plugins/DebugBridge */ \"./src/plugins/DebugBridge.ts\");\n/* harmony import */ var pako__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! pako */ \"./node_modules/pako/dist/pako.esm.mjs\");\n/* harmony import */ var untar_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! untar.js */ \"./node_modules/untar.js/lib/untar.js\");\n/* harmony import */ var _ACEV2DOM__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./ACEV2DOM */ \"./src/core/api/ACEV2DOM.ts\");\n/* harmony import */ var _Variable__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./Variable */ \"./src/core/api/Variable.ts\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (undefined && undefined.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArray = (undefined && undefined.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar PluginToolkit = /** @class */ (function () {\n    function PluginToolkit() {\n        this.tombstones = [];\n        this.apiImplementations = {\n            showDialog: function (_a) {\n                var title = _a.title, content = _a.content, okAction = _a.okAction, cancelAction = _a.cancelAction;\n                return _plugins_ACEV2Dialog__WEBPACK_IMPORTED_MODULE_3__[\"default\"].showDialog({ title: title, content: content, okAction: okAction, cancelAction: cancelAction });\n            },\n            showToast: function (_a) {\n                var text = _a.text;\n                return _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: text });\n            },\n            aceLog: {\n                info: function (_a) {\n                    var message = _a.message;\n                    return _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].info({ message: message });\n                },\n                success: function (_a) {\n                    var message = _a.message;\n                    return _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].success({ message: message });\n                },\n                warn: function (_a) {\n                    var message = _a.message;\n                    return _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].warn({ message: message });\n                },\n                error: function (_a) {\n                    var message = _a.message;\n                    return _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error({ message: message });\n                }\n            },\n            isDarkMode: function () { return _Preferences__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isDarkMode(); },\n            ACEV2DOM: {\n                injectHTML: function (_a) {\n                    var HTMLCode = _a.HTMLCode;\n                    return _ACEV2DOM__WEBPACK_IMPORTED_MODULE_14__[\"default\"].injectHTML({ HTMLCode: HTMLCode });\n                },\n                removeHTML: function (_a) {\n                    var tracker = _a.tracker;\n                    return _ACEV2DOM__WEBPACK_IMPORTED_MODULE_14__[\"default\"].removeElement({ tracker: tracker });\n                }\n            }\n        };\n    }\n    PluginToolkit.prototype.installPlugin = function (_a) {\n        return __awaiter(this, arguments, void 0, function (_b) {\n            var psvResult, e_1, installedPlugins, existingPluginIndex, installedPlugins;\n            var pluginPack = _b.pluginPack, bridged = _b.bridged;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        psvResult = false;\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 5, , 6]);\n                        if (!(_Preferences__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getPreference({ category: 'developer', k: 'psv' }) !== 'none')) return [3 /*break*/, 3];\n                        return [4 /*yield*/, _Security__WEBPACK_IMPORTED_MODULE_1__[\"default\"].psv({ signature: pluginPack.signature, pluginSelf: pluginPack.self })];\n                    case 2:\n                        psvResult = _c.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        psvResult = true;\n                        _c.label = 4;\n                    case 4: return [3 /*break*/, 6];\n                    case 5:\n                        e_1 = _c.sent();\n                        _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'psv-check-failed-installation-denied' }) });\n                        return [3 /*break*/, 6];\n                    case 6:\n                        if (!psvResult) {\n                            _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: \"\\u5B89\\u88C5\\u88AB\\u62D2\\u7EDD, \\u6B64\\u63D2\\u4EF6\\u300C\".concat(pluginPack.manifest.id, \"\\u300D\\u672A\\u901A\\u8FC7PSV\\u68C0\\u67E5\\u3002\") });\n                            return [2 /*return*/];\n                        }\n                        if (this.checkIfInstalled({ pluginPack: pluginPack })) {\n                            _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: \"\\u5B89\\u88C5\\u88AB\\u62D2\\u7EDD, \\u6B64\\u63D2\\u4EF6\\u300C\".concat(pluginPack.manifest.id, \"\\u300D\\u5DF2\\u7ECF\\u5B89\\u88C5\\u3002\") });\n                            return [2 /*return*/];\n                        }\n                        if (bridged) {\n                            installedPlugins = this.getInstalledPlugins();\n                            pluginPack.enabled = true;\n                            pluginPack.manifest.bridged = true;\n                            existingPluginIndex = installedPlugins.findIndex(function (plugin) { return plugin.manifest.id === pluginPack.manifest.id; });\n                            if (existingPluginIndex !== -1) {\n                                installedPlugins[existingPluginIndex] = pluginPack;\n                            }\n                            else {\n                                installedPlugins.push(pluginPack);\n                            }\n                            this.saveInstalledPlugins({ installedPlugins: installedPlugins });\n                        }\n                        else {\n                            installedPlugins = this.getInstalledPlugins();\n                            pluginPack.enabled = true;\n                            installedPlugins.push(pluginPack);\n                            this.saveInstalledPlugins({ installedPlugins: installedPlugins });\n                            _plugins_ACEV2Dialog__WEBPACK_IMPORTED_MODULE_3__[\"default\"].showDialog({\n                                title: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'installation-succeed' }),\n                                content: \"\\u6B64\\u63D2\\u4EF6\\u300C\".concat(pluginPack.manifest.id, \"\\u300D\\u5DF2\\u88AB\\u5B89\\u88C5\\uFF0C\\u6309\\u4E0B\\u300C\\u597D\\u300D\\u540E\\u5C06\\u5237\\u65B0\\u9875\\u9762\\u4EE5\\u8F7D\\u5165\\u63D2\\u4EF6\\u3002\"),\n                                okAction: function () {\n                                    location.reload();\n                                }\n                            });\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    PluginToolkit.prototype.uninstallPlugin = function (_a) {\n        var manifest = _a.manifest;\n        var id = manifest.id;\n        _plugins_ACEV2Loader__WEBPACK_IMPORTED_MODULE_6__[\"default\"].draw();\n        try {\n            var installedPlugins = this.getInstalledPlugins();\n            var newInstalledPlugins = installedPlugins.filter(function (installedPlugin) { return installedPlugin.manifest.id !== id; });\n            this.saveInstalledPlugins({ installedPlugins: newInstalledPlugins });\n            _plugins_ACEV2Dialog__WEBPACK_IMPORTED_MODULE_3__[\"default\"].showDialog({\n                title: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'uninstallation-succeed' }),\n                content: \"\\u63D2\\u4EF6\\u300C\".concat(id, \"\\u300D\\u5378\\u8F7D\\u5B8C\\u6210\\uFF0C\\u70B9\\u51FB\\u300C\\u597D\\u300D\\u4EE5\\u5237\\u65B0\\u9875\\u9762\\u3002\"),\n                okAction: function () { return location.reload(); }\n            });\n        }\n        catch (e) {\n            _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: \"\\u63D2\\u4EF6\\u89E3\\u9664\\u5B89\\u88C5\\u5931\\u8D25\\uFF0C\\u5728\\u5C1D\\u8BD5\\u89E3\\u9664\\u5B89\\u88C5\\u63D2\\u4EF6\\u300C\".concat(id, \"\\u300D\\u65F6\\u51FA\\u73B0\\u9519\\u8BEF\\uFF0C\\u8BF7\\u518D\\u8BD5\\u4E00\\u6B21\\u3002\") });\n            _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error({ message: JSON.stringify(e) });\n        }\n        _plugins_ACEV2Loader__WEBPACK_IMPORTED_MODULE_6__[\"default\"].destroy();\n    };\n    PluginToolkit.prototype.uninstallBridgedPlugin = function () {\n        var installedPlugins = this.getInstalledPlugins();\n        var bridgedPlugins = installedPlugins.filter(function (i) { return i.manifest.bridged === true; });\n        if (bridgedPlugins.length !== 0) {\n            var id_1 = bridgedPlugins[0].manifest.id;\n            if (id_1) {\n                try {\n                    var installedPlugins_1 = this.getInstalledPlugins();\n                    var newInstalledPlugins = installedPlugins_1.filter(function (installedPlugin) { return installedPlugin.manifest.id !== id_1; });\n                    this.saveInstalledPlugins({ installedPlugins: newInstalledPlugins });\n                    _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].success({ message: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'uninstalled-bridged-plugin' }) + id_1 });\n                    _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'uninstalled-bridged-plugin' }) + id_1 + _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'please-reload-page' }) });\n                }\n                catch (e) {\n                    _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'uninstall-bridged-plugin-failed' }) + id_1 + _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'please-try-again' }) });\n                    _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error({ message: JSON.stringify(e) });\n                }\n            }\n        }\n    };\n    PluginToolkit.prototype.checkIfInstalled = function (_a) {\n        var pluginPack = _a.pluginPack;\n        var installedPlugins = this.getInstalledPlugins();\n        var isInstalled = false;\n        installedPlugins.forEach(function (installedPlugin) {\n            if (installedPlugin.manifest.id === pluginPack.manifest.id) {\n                isInstalled = true;\n            }\n        });\n        return isInstalled;\n    };\n    PluginToolkit.prototype.getInstalledPlugins = function () {\n        var installedPlugins = _services_ACEV2Storage__WEBPACK_IMPORTED_MODULE_5__[\"default\"].getPlugins();\n        if (!installedPlugins) {\n            installedPlugins = [];\n            this.saveInstalledPlugins({ installedPlugins: installedPlugins });\n        }\n        return installedPlugins;\n    };\n    PluginToolkit.prototype.saveInstalledPlugins = function (_a) {\n        var installedPlugins = _a.installedPlugins;\n        _services_ACEV2Storage__WEBPACK_IMPORTED_MODULE_5__[\"default\"].updatePluginsStorage({ newPlugins: installedPlugins });\n    };\n    PluginToolkit.prototype.getSelfPreference = function (_a) {\n        var manifest = _a.manifest;\n        var installedPlugins = this.getInstalledPlugins();\n        var targetPlugin = installedPlugins.find(function (installedPlugin) { return installedPlugin.manifest.id === manifest.id; });\n        return targetPlugin.manifest.settings;\n    };\n    PluginToolkit.prototype.saveSelfPreference = function (_a) {\n        var manifest = _a.manifest, settings = _a.settings;\n        var installedPlugins = this.getInstalledPlugins();\n        var targetPlugin = installedPlugins.find(function (installedPlugin) { return installedPlugin.manifest.id === manifest.id; });\n        targetPlugin.manifest.settings = settings;\n        this.saveInstalledPlugins({ installedPlugins: installedPlugins });\n    };\n    PluginToolkit.prototype.initializePluginExecutionAndSetTrigger = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var installedPlugins, __tombstones, _loop_1, _i, installedPlugins_2, installedPlugin;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        installedPlugins = this.getInstalledPlugins();\n                        __tombstones = [];\n                        if (installedPlugins.length === 0)\n                            return [2 /*return*/];\n                        _loop_1 = function (installedPlugin) {\n                            var self_1, manifest, allApisDefined, args, filteredArgs;\n                            return __generator(this, function (_b) {\n                                switch (_b.label) {\n                                    case 0:\n                                        if (!installedPlugin.enabled)\n                                            return [2 /*return*/, \"continue\"];\n                                        self_1 = installedPlugin.self, manifest = installedPlugin.manifest;\n                                        allApisDefined = true;\n                                        return [4 /*yield*/, Promise.all(manifest.requestedAPIs.map(function (apiName) { return __awaiter(_this, void 0, void 0, function () {\n                                                return __generator(this, function (_a) {\n                                                    if (this.apiImplementations[apiName]) {\n                                                        return [2 /*return*/, { name: apiName, target: this.apiImplementations[apiName] }];\n                                                    }\n                                                    else {\n                                                        _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error({ message: \"Error loading plugin tombstone \".concat(manifest.id, \", cannot resolve API \").concat(apiName, \" of undefined.\") });\n                                                        _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: \"\\u63D2\\u4EF6\\u300C\".concat(manifest.id, \"\\u300D\\u8BF7\\u6C42\\u4E86\\u4E00\\u4E2A\\u672A\\u5B9A\\u4E49\\u7684API\\u300C\").concat(apiName, \"\\u300D\\uFF0C\\u56E0\\u6B64\\u62D2\\u7EDD\\u8F7D\\u5165\\u6B64\\u63D2\\u4EF6\\u3002\") });\n                                                        allApisDefined = false;\n                                                        return [2 /*return*/, undefined];\n                                                    }\n                                                    return [2 /*return*/];\n                                                });\n                                            }); }))];\n                                    case 1:\n                                        args = _b.sent();\n                                        if (!allApisDefined)\n                                            return [2 /*return*/, \"continue\"];\n                                        filteredArgs = args.filter(function (arg) { return arg !== undefined; });\n                                        if (filteredArgs.length === manifest.requestedAPIs.length) {\n                                            try {\n                                                __tombstones.push({\n                                                    self: self_1,\n                                                    manifest: manifest,\n                                                    args: filteredArgs,\n                                                    executed: false\n                                                });\n                                            }\n                                            catch (error) {\n                                                _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error({ message: \"Error creating plugin tombstone \".concat(manifest.id, \": \").concat(JSON.stringify(error)) });\n                                                _plugins_ACEV2Dialog__WEBPACK_IMPORTED_MODULE_3__[\"default\"].showDialog({\n                                                    title: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'request-reload' }),\n                                                    content: \"\\u63D2\\u4EF6\\u8F7D\\u5165\\u5668\\u5728\\u751F\\u6210\\u63D2\\u4EF6\\u300C\".concat(manifest.id, \"\\u300D\\u7684\\u5893\\u7891\\u4E2D\\u51FA\\u73B0\\u9519\\u8BEF\").concat(error, \"\\uFF0C\\u56E0\\u6B64AcFun Evolved\\u5DF2\\u4E2D\\u6B62\\u8FD0\\u884C\\uFF0C\\u6309\\u4E0B\\u300C\\u597D\\u300D\\u4EE5\\u91CD\\u65B0\\u542F\\u52A8AcFun Evolved.\"),\n                                                    okAction: function () { return location.reload(); }\n                                                });\n                                            }\n                                        }\n                                        return [2 /*return*/];\n                                }\n                            });\n                        };\n                        _i = 0, installedPlugins_2 = installedPlugins;\n                        _a.label = 1;\n                    case 1:\n                        if (!(_i < installedPlugins_2.length)) return [3 /*break*/, 4];\n                        installedPlugin = installedPlugins_2[_i];\n                        return [5 /*yield**/, _loop_1(installedPlugin)];\n                    case 2:\n                        _a.sent();\n                        _a.label = 3;\n                    case 3:\n                        _i++;\n                        return [3 /*break*/, 1];\n                    case 4:\n                        this.tombstones = __tombstones;\n                        return [4 /*yield*/, this.ferryman()];\n                    case 5:\n                        _a.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    ;\n    PluginToolkit.prototype.ferryman = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var executeTombstones;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        executeTombstones = function (_a) { return __awaiter(_this, [_a], void 0, function (_b) {\n                            var __tombstones, _i, __tombstones_1, tombstone, self_2, args, manifest, requiredPatterns, isMatch, targetFunction;\n                            var _this = this;\n                            var currentUrl = _b.currentUrl;\n                            return __generator(this, function (_c) {\n                                __tombstones = this.tombstones;\n                                for (_i = 0, __tombstones_1 = __tombstones; _i < __tombstones_1.length; _i++) {\n                                    tombstone = __tombstones_1[_i];\n                                    if (tombstone.executed)\n                                        continue;\n                                    self_2 = tombstone.self, args = tombstone.args, manifest = tombstone.manifest;\n                                    if (manifest.trigger.matches && manifest.trigger.matches.length > 0) {\n                                        requiredPatterns = manifest.trigger.matches.flatMap(function (key) { return _ACEV2URL__WEBPACK_IMPORTED_MODULE_8__.pageList[key] || []; });\n                                        isMatch = requiredPatterns.some(function (pattern) { return pattern.test(currentUrl); });\n                                        if (isMatch) {\n                                            try {\n                                                _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].info({ message: \"executed \".concat(manifest.id) });\n                                                targetFunction = new (Function.bind.apply(Function, __spreadArray(__spreadArray([void 0], args.map(function (arg) { return arg.name; }), false), ['manifest', 'getSelfPreference', self_2], false)))();\n                                                // const targetFunction = new Function(...args.map((arg: any) => arg.name), 'manifest', `(()=>{\"use strict\";(async()=>{console.log('-------------------')})();`);\n                                                targetFunction.apply(void 0, __spreadArray(__spreadArray([], args.map(function (arg) { return arg.target; }), false), [manifest, function (_a) {\n                                                        var manifest = _a.manifest;\n                                                        return _this.getSelfPreference({ manifest: manifest });\n                                                    }], false));\n                                                tombstone.executed = true;\n                                            }\n                                            catch (e) {\n                                                _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error({ message: \"Error ferrying plugin \".concat(manifest.id, \": \").concat(JSON.stringify(e)) });\n                                                _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: \"\\u6446\\u6E21\\u4EBA\\u5728\\u6267\\u884C\\u63D2\\u4EF6\\u300C\".concat(manifest.id, \"\\u300D\\u4E2D\\u51FA\\u73B0\\u9519\\u8BEF\").concat(JSON.stringify(e), \"\\uFF0C\\u56E0\\u6B64\\u5DF2\\u4E2D\\u6B62\\u8FD0\\u884C\\u6B64\\u63D2\\u4EF6\\u3002\") });\n                                            }\n                                        }\n                                    }\n                                }\n                                this.tombstones = __tombstones;\n                                return [2 /*return*/];\n                            });\n                        }); };\n                        return [4 /*yield*/, executeTombstones({ currentUrl: window.location.href })];\n                    case 1:\n                        _a.sent();\n                        _Supervisor__WEBPACK_IMPORTED_MODULE_9__[\"default\"].urlChange(function (currentUrl) { return __awaiter(_this, void 0, void 0, function () {\n                            return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                    case 0: return [4 /*yield*/, executeTombstones({ currentUrl: currentUrl })];\n                                    case 1:\n                                        _a.sent();\n                                        return [2 /*return*/];\n                                }\n                            });\n                        }); });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    ;\n    PluginToolkit.prototype.wakeUpBuildInPlugins = function () {\n        if (_Preferences__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getPreference({ category: 'developer', k: 'psv' }) !== 'full') {\n            _plugins_DebugBridge__WEBPACK_IMPORTED_MODULE_11__[\"default\"].wakeUp();\n        }\n        _plugins_PluginStore__WEBPACK_IMPORTED_MODULE_10__[\"default\"].wakeUp();\n    };\n    PluginToolkit.prototype.extractAndInstallPlugin = function (_a) {\n        var _this = this;\n        var compressedData = _a.compressedData;\n        _plugins_ACEV2Dialog__WEBPACK_IMPORTED_MODULE_3__[\"default\"].showDialog({\n            title: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'wants-to-extract-and-install-plugin-package' }) }),\n            content: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'do-you-really-want-to-do-that' }),\n            okAction: function () { return __awaiter(_this, void 0, void 0, function () {\n                var decompressedArrayBuffer, files, rawObject, pack, err_1;\n                return __generator(this, function (_a) {\n                    switch (_a.label) {\n                        case 0:\n                            _plugins_ACEV2Loader__WEBPACK_IMPORTED_MODULE_6__[\"default\"].draw();\n                            _a.label = 1;\n                        case 1:\n                            _a.trys.push([1, 3, , 4]);\n                            decompressedArrayBuffer = pako__WEBPACK_IMPORTED_MODULE_12__[\"default\"].inflate(new Uint8Array(compressedData));\n                            if (!decompressedArrayBuffer.buffer) {\n                                _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'decompressed-data-does-not-contain-valid-buffer-property' }) });\n                                return [2 /*return*/];\n                            }\n                            files = (0,untar_js__WEBPACK_IMPORTED_MODULE_13__.untar)(decompressedArrayBuffer.buffer);\n                            if (!files || files.length === 0) {\n                                _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'no-files-extracted-from-the-compressed-data' }) });\n                                return [2 /*return*/];\n                            }\n                            rawObject = files[0];\n                            rawObject = new TextDecoder().decode(rawObject.fileData);\n                            pack = JSON.parse(rawObject);\n                            return [4 /*yield*/, this.installPlugin({ pluginPack: pack, bridged: false })];\n                        case 2:\n                            _a.sent();\n                            return [3 /*break*/, 4];\n                        case 3:\n                            err_1 = _a.sent();\n                            _Logger__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error({ message: \"Error extracting and installing plugin package: \".concat(JSON.stringify(err_1)) });\n                            _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: _I18n__WEBPACK_IMPORTED_MODULE_4__[\"default\"].t({ key: 'error-extracting-and-installing-plugin-package' }) });\n                            return [3 /*break*/, 4];\n                        case 4:\n                            _plugins_ACEV2Loader__WEBPACK_IMPORTED_MODULE_6__[\"default\"].destroy();\n                            return [2 /*return*/];\n                    }\n                });\n            }); },\n            cancelAction: function () { return _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: 'canceled' }); }\n        });\n    };\n    ;\n    PluginToolkit.prototype.downloadAndInstallPluginPack = function (_a) {\n        return __awaiter(this, arguments, void 0, function (_b) {\n            var fullDownloadUrl;\n            var _this = this;\n            var manifest = _b.manifest;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0: return [4 /*yield*/, _Variable__WEBPACK_IMPORTED_MODULE_15__[\"default\"].pluginDownloadURL(bigManifest)];\n                    case 1:\n                        fullDownloadUrl = _c.sent();\n                        return [4 /*yield*/, openDialog(\"AcFun Evolved Runtime \\u8981\\u5B89\\u88C5 \\u300C\".concat(bigManifest.id.original, \"\\u300D \"), \"AcFun Evolved Runtime \\u8981\\u4ECE \\u300C\".concat(fullDownloadUrl, \"\\u300D \\u4E0B\\u8F7D \\u300C\").concat(bigManifest.id.original, \"\\u300D \\u7136\\u540E\\u5B89\\u88C5\\uFF0C\\u6B64\\u94FE\\u63A5\\uFF1A\").concat(isTrustable(fullDownloadUrl) ? '受信任' : '不受信任'), false, function () { return __awaiter(_this, void 0, void 0, function () {\n                                var loaderData, compressedPack, decompressedContent, files, rawObject, pack, err_2;\n                                return __generator(this, function (_a) {\n                                    switch (_a.label) {\n                                        case 0: return [4 /*yield*/, addLoader(loaderAceUuid)];\n                                        case 1:\n                                            loaderData = _a.sent();\n                                            return [4 /*yield*/, monkey({\n                                                    method: 'GET',\n                                                    url: fullDownloadUrl,\n                                                    responseType: 'arraybuffer'\n                                                })];\n                                        case 2:\n                                            compressedPack = _a.sent();\n                                            _a.label = 3;\n                                        case 3:\n                                            _a.trys.push([3, 5, , 7]);\n                                            decompressedContent = pako__WEBPACK_IMPORTED_MODULE_12__[\"default\"].inflate(compressedPack);\n                                            files = (0,untar_js__WEBPACK_IMPORTED_MODULE_13__.untar)(decompressedContent);\n                                            rawObject = files[0];\n                                            rawObject = new TextDecoder().decode(rawObject.fileData);\n                                            pack = JSON.parse(rawObject);\n                                            return [4 /*yield*/, installPlugin(pack)];\n                                        case 4:\n                                            _a.sent();\n                                            return [3 /*break*/, 7];\n                                        case 5:\n                                            err_2 = _a.sent();\n                                            console.error('解压缩失败', err_2);\n                                            return [4 /*yield*/, openDialog('插件安装器无法解压缩', \"\\u63D2\\u4EF6\\u300C\".concat(bigManifest.id.original, \"\\u300D\\u7684\\u5B89\\u88C5\\u65E0\\u6CD5\\u5B8C\\u6210\\uFF0C\\u56E0\\u4E3A\\u63D2\\u4EF6\\u5B89\\u88C5\\u5668\\u65E0\\u6CD5\\u6210\\u529F\\u89E3\\u538B\\u7F29\\uFF0C\\u8BF7\\u518D\\u8BD5\\u4E00\\u6B21\\u3002\"), true, function () {\n                                                }, function () {\n                                                })];\n                                        case 6:\n                                            _a.sent();\n                                            return [3 /*break*/, 7];\n                                        case 7: return [4 /*yield*/, removeLoader(loaderData)];\n                                        case 8:\n                                            _a.sent();\n                                            return [2 /*return*/];\n                                    }\n                                });\n                            }); }, function () { return __awaiter(_this, void 0, void 0, function () {\n                                return __generator(this, function (_a) {\n                                    switch (_a.label) {\n                                        case 0: return [4 /*yield*/, openDialog('插件安装被取消', \"\\u63D2\\u4EF6\\u300C\".concat(bigManifest.id.original, \"\\u300D\\u7684\\u5B89\\u88C5\\u88AB\\u53D6\\u6D88\\u3002\"), true, function () {\n                                            }, function () {\n                                            })];\n                                        case 1:\n                                            _a.sent();\n                                            return [2 /*return*/];\n                                    }\n                                });\n                            }); })];\n                    case 2:\n                        _c.sent();\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return PluginToolkit;\n}());\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new PluginToolkit());\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLGtDQUFrQztBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLCtDQUFNLFNBQVMsMkZBQTJGO0FBQ3RJLDRCQUE0QiwyREFBVSxhQUFhLE1BQU0sNkNBQUksS0FBSyx1REFBdUQsR0FBRztBQUM1SDtBQUNBO0FBQ0EsNEJBQTRCLDREQUFXO0FBQ3ZDO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakIsYUFBYSxJQUFJO0FBQ2pCLHdDQUF3QyxPQUFPLDJEQUFVLGFBQWEsa0JBQWtCO0FBQ3hGLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsa0RBQVE7QUFDekQ7QUFDQTtBQUNBLHFhQUFxYTtBQUNyYTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRDtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFLHFEQUFZO0FBQzlFLG9EQUFvRCxnREFBSztBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlEO0FBQ2pELGlEQUFpRDtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDLDZCQUE2QixJQUFJLGdCQUFnQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkM7QUFDN0MsNkNBQTZDO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDLDZCQUE2QixJQUFJO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQztBQUNELGlFQUFlLG1CQUFtQixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWNmdW5fZXZvbHZlZC8uL3NyYy9jb3JlL2FwaS9QbHVnaW5Ub29sa2l0LnRzP2Y2YTMiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG52YXIgX19nZW5lcmF0b3IgPSAodGhpcyAmJiB0aGlzLl9fZ2VuZXJhdG9yKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgYm9keSkge1xuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XG4gICAgICAgIHdoaWxlIChnICYmIChnID0gMCwgb3BbMF0gJiYgKF8gPSAwKSksIF8pIHRyeSB7XG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcbiAgICB9XG59O1xudmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuaW1wb3J0IFByZWZlcmVuY2VzIGZyb20gXCIuL1ByZWZlcmVuY2VzXCI7XG5pbXBvcnQgU2VjdXJpdHkgZnJvbSBcIi4vU2VjdXJpdHlcIjtcbmltcG9ydCBBQ0VWMlRvYXN0IGZyb20gXCIuLi8uLi9wbHVnaW5zL0FDRVYyVG9hc3RcIjtcbmltcG9ydCBBQ0VWMkRpYWxvZyBmcm9tIFwiLi4vLi4vcGx1Z2lucy9BQ0VWMkRpYWxvZ1wiO1xuaW1wb3J0IEkxOG4gZnJvbSBcIi4vSTE4blwiO1xuaW1wb3J0IEFDRVYyU3RvcmFnZSBmcm9tIFwiLi4vc2VydmljZXMvQUNFVjJTdG9yYWdlXCI7XG5pbXBvcnQgQUNFVjJMb2FkZXIgZnJvbSBcIi4uLy4uL3BsdWdpbnMvQUNFVjJMb2FkZXJcIjtcbmltcG9ydCBMb2dnZXIgZnJvbSBcIi4vTG9nZ2VyXCI7XG5pbXBvcnQgeyBwYWdlTGlzdCB9IGZyb20gXCIuL0FDRVYyVVJMXCI7XG5pbXBvcnQgU3VwZXJ2aXNvciBmcm9tIFwiLi9TdXBlcnZpc29yXCI7XG5pbXBvcnQgUGx1Z2luU3RvcmUgZnJvbSBcIi4uLy4uL3BsdWdpbnMvUGx1Z2luU3RvcmVcIjtcbmltcG9ydCBEZWJ1Z0JyaWRnZSBmcm9tIFwiLi4vLi4vcGx1Z2lucy9EZWJ1Z0JyaWRnZVwiO1xuaW1wb3J0IHBha28gZnJvbSBcInBha29cIjtcbmltcG9ydCB7IHVudGFyIH0gZnJvbSBcInVudGFyLmpzXCI7XG5pbXBvcnQgQUNFVjJET00gZnJvbSBcIi4vQUNFVjJET01cIjtcbmltcG9ydCBWYXJpYWJsZSBmcm9tIFwiLi9WYXJpYWJsZVwiO1xudmFyIFBsdWdpblRvb2xraXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUGx1Z2luVG9vbGtpdCgpIHtcbiAgICAgICAgdGhpcy50b21ic3RvbmVzID0gW107XG4gICAgICAgIHRoaXMuYXBpSW1wbGVtZW50YXRpb25zID0ge1xuICAgICAgICAgICAgc2hvd0RpYWxvZzogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gX2EudGl0bGUsIGNvbnRlbnQgPSBfYS5jb250ZW50LCBva0FjdGlvbiA9IF9hLm9rQWN0aW9uLCBjYW5jZWxBY3Rpb24gPSBfYS5jYW5jZWxBY3Rpb247XG4gICAgICAgICAgICAgICAgcmV0dXJuIEFDRVYyRGlhbG9nLnNob3dEaWFsb2coeyB0aXRsZTogdGl0bGUsIGNvbnRlbnQ6IGNvbnRlbnQsIG9rQWN0aW9uOiBva0FjdGlvbiwgY2FuY2VsQWN0aW9uOiBjYW5jZWxBY3Rpb24gfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2hvd1RvYXN0OiBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IF9hLnRleHQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEFDRVYyVG9hc3Quc2hvd1RvYXN0KHsgdGV4dDogdGV4dCB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhY2VMb2c6IHtcbiAgICAgICAgICAgICAgICBpbmZvOiBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBfYS5tZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTG9nZ2VyLmluZm8oeyBtZXNzYWdlOiBtZXNzYWdlIH0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gX2EubWVzc2FnZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIExvZ2dlci5zdWNjZXNzKHsgbWVzc2FnZTogbWVzc2FnZSB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHdhcm46IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IF9hLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBMb2dnZXIud2Fybih7IG1lc3NhZ2U6IG1lc3NhZ2UgfSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gX2EubWVzc2FnZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIExvZ2dlci5lcnJvcih7IG1lc3NhZ2U6IG1lc3NhZ2UgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGlzRGFya01vZGU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFByZWZlcmVuY2VzLmlzRGFya01vZGUoKTsgfSxcbiAgICAgICAgICAgIEFDRVYyRE9NOiB7XG4gICAgICAgICAgICAgICAgaW5qZWN0SFRNTDogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBIVE1MQ29kZSA9IF9hLkhUTUxDb2RlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQUNFVjJET00uaW5qZWN0SFRNTCh7IEhUTUxDb2RlOiBIVE1MQ29kZSB9KTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlbW92ZUhUTUw6IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhY2tlciA9IF9hLnRyYWNrZXI7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBBQ0VWMkRPTS5yZW1vdmVFbGVtZW50KHsgdHJhY2tlcjogdHJhY2tlciB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIFBsdWdpblRvb2xraXQucHJvdG90eXBlLmluc3RhbGxQbHVnaW4gPSBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCBhcmd1bWVudHMsIHZvaWQgMCwgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICB2YXIgcHN2UmVzdWx0LCBlXzEsIGluc3RhbGxlZFBsdWdpbnMsIGV4aXN0aW5nUGx1Z2luSW5kZXgsIGluc3RhbGxlZFBsdWdpbnM7XG4gICAgICAgICAgICB2YXIgcGx1Z2luUGFjayA9IF9iLnBsdWdpblBhY2ssIGJyaWRnZWQgPSBfYi5icmlkZ2VkO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgcHN2UmVzdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5sYWJlbCA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLnRyeXMucHVzaChbMSwgNSwgLCA2XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShQcmVmZXJlbmNlcy5nZXRQcmVmZXJlbmNlKHsgY2F0ZWdvcnk6ICdkZXZlbG9wZXInLCBrOiAncHN2JyB9KSAhPT0gJ25vbmUnKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgM107XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBTZWN1cml0eS5wc3YoeyBzaWduYXR1cmU6IHBsdWdpblBhY2suc2lnbmF0dXJlLCBwbHVnaW5TZWxmOiBwbHVnaW5QYWNrLnNlbGYgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBwc3ZSZXN1bHQgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgcHN2UmVzdWx0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9jLmxhYmVsID0gNDtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OiByZXR1cm4gWzMgLypicmVhayovLCA2XTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgICAgICAgICAgZV8xID0gX2Muc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgQUNFVjJUb2FzdC5zaG93VG9hc3QoeyB0ZXh0OiBJMThuLnQoeyBrZXk6ICdwc3YtY2hlY2stZmFpbGVkLWluc3RhbGxhdGlvbi1kZW5pZWQnIH0pIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcHN2UmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQUNFVjJUb2FzdC5zaG93VG9hc3QoeyB0ZXh0OiBcIlxcdTVCODlcXHU4OEM1XFx1ODhBQlxcdTYyRDJcXHU3RURELCBcXHU2QjY0XFx1NjNEMlxcdTRFRjZcXHUzMDBDXCIuY29uY2F0KHBsdWdpblBhY2subWFuaWZlc3QuaWQsIFwiXFx1MzAwRFxcdTY3MkFcXHU5MDFBXFx1OEZDN1BTVlxcdTY4QzBcXHU2N0U1XFx1MzAwMlwiKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jaGVja0lmSW5zdGFsbGVkKHsgcGx1Z2luUGFjazogcGx1Z2luUGFjayB9KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFDRVYyVG9hc3Quc2hvd1RvYXN0KHsgdGV4dDogXCJcXHU1Qjg5XFx1ODhDNVxcdTg4QUJcXHU2MkQyXFx1N0VERCwgXFx1NkI2NFxcdTYzRDJcXHU0RUY2XFx1MzAwQ1wiLmNvbmNhdChwbHVnaW5QYWNrLm1hbmlmZXN0LmlkLCBcIlxcdTMwMERcXHU1REYyXFx1N0VDRlxcdTVCODlcXHU4OEM1XFx1MzAwMlwiKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYnJpZGdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZFBsdWdpbnMgPSB0aGlzLmdldEluc3RhbGxlZFBsdWdpbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW5QYWNrLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBsdWdpblBhY2subWFuaWZlc3QuYnJpZGdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpc3RpbmdQbHVnaW5JbmRleCA9IGluc3RhbGxlZFBsdWdpbnMuZmluZEluZGV4KGZ1bmN0aW9uIChwbHVnaW4pIHsgcmV0dXJuIHBsdWdpbi5tYW5pZmVzdC5pZCA9PT0gcGx1Z2luUGFjay5tYW5pZmVzdC5pZDsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nUGx1Z2luSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZFBsdWdpbnNbZXhpc3RpbmdQbHVnaW5JbmRleF0gPSBwbHVnaW5QYWNrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFsbGVkUGx1Z2lucy5wdXNoKHBsdWdpblBhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmVJbnN0YWxsZWRQbHVnaW5zKHsgaW5zdGFsbGVkUGx1Z2luczogaW5zdGFsbGVkUGx1Z2lucyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZFBsdWdpbnMgPSB0aGlzLmdldEluc3RhbGxlZFBsdWdpbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwbHVnaW5QYWNrLmVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbGxlZFBsdWdpbnMucHVzaChwbHVnaW5QYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmVJbnN0YWxsZWRQbHVnaW5zKHsgaW5zdGFsbGVkUGx1Z2luczogaW5zdGFsbGVkUGx1Z2lucyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBQ0VWMkRpYWxvZy5zaG93RGlhbG9nKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IEkxOG4udCh7IGtleTogJ2luc3RhbGxhdGlvbi1zdWNjZWVkJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogXCJcXHU2QjY0XFx1NjNEMlxcdTRFRjZcXHUzMDBDXCIuY29uY2F0KHBsdWdpblBhY2subWFuaWZlc3QuaWQsIFwiXFx1MzAwRFxcdTVERjJcXHU4OEFCXFx1NUI4OVxcdTg4QzVcXHVGRjBDXFx1NjMwOVxcdTRFMEJcXHUzMDBDXFx1NTk3RFxcdTMwMERcXHU1NDBFXFx1NUMwNlxcdTUyMzdcXHU2NUIwXFx1OTg3NVxcdTk3NjJcXHU0RUU1XFx1OEY3RFxcdTUxNjVcXHU2M0QyXFx1NEVGNlxcdTMwMDJcIiksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9rQWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFBsdWdpblRvb2xraXQucHJvdG90eXBlLnVuaW5zdGFsbFBsdWdpbiA9IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgbWFuaWZlc3QgPSBfYS5tYW5pZmVzdDtcbiAgICAgICAgdmFyIGlkID0gbWFuaWZlc3QuaWQ7XG4gICAgICAgIEFDRVYyTG9hZGVyLmRyYXcoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBpbnN0YWxsZWRQbHVnaW5zID0gdGhpcy5nZXRJbnN0YWxsZWRQbHVnaW5zKCk7XG4gICAgICAgICAgICB2YXIgbmV3SW5zdGFsbGVkUGx1Z2lucyA9IGluc3RhbGxlZFBsdWdpbnMuZmlsdGVyKGZ1bmN0aW9uIChpbnN0YWxsZWRQbHVnaW4pIHsgcmV0dXJuIGluc3RhbGxlZFBsdWdpbi5tYW5pZmVzdC5pZCAhPT0gaWQ7IH0pO1xuICAgICAgICAgICAgdGhpcy5zYXZlSW5zdGFsbGVkUGx1Z2lucyh7IGluc3RhbGxlZFBsdWdpbnM6IG5ld0luc3RhbGxlZFBsdWdpbnMgfSk7XG4gICAgICAgICAgICBBQ0VWMkRpYWxvZy5zaG93RGlhbG9nKHtcbiAgICAgICAgICAgICAgICB0aXRsZTogSTE4bi50KHsga2V5OiAndW5pbnN0YWxsYXRpb24tc3VjY2VlZCcgfSksXG4gICAgICAgICAgICAgICAgY29udGVudDogXCJcXHU2M0QyXFx1NEVGNlxcdTMwMENcIi5jb25jYXQoaWQsIFwiXFx1MzAwRFxcdTUzNzhcXHU4RjdEXFx1NUI4Q1xcdTYyMTBcXHVGRjBDXFx1NzBCOVxcdTUxRkJcXHUzMDBDXFx1NTk3RFxcdTMwMERcXHU0RUU1XFx1NTIzN1xcdTY1QjBcXHU5ODc1XFx1OTc2MlxcdTMwMDJcIiksXG4gICAgICAgICAgICAgICAgb2tBY3Rpb246IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGxvY2F0aW9uLnJlbG9hZCgpOyB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgQUNFVjJUb2FzdC5zaG93VG9hc3QoeyB0ZXh0OiBcIlxcdTYzRDJcXHU0RUY2XFx1ODlFM1xcdTk2NjRcXHU1Qjg5XFx1ODhDNVxcdTU5MzFcXHU4RDI1XFx1RkYwQ1xcdTU3MjhcXHU1QzFEXFx1OEJENVxcdTg5RTNcXHU5NjY0XFx1NUI4OVxcdTg4QzVcXHU2M0QyXFx1NEVGNlxcdTMwMENcIi5jb25jYXQoaWQsIFwiXFx1MzAwRFxcdTY1RjZcXHU1MUZBXFx1NzNCMFxcdTk1MTlcXHU4QkVGXFx1RkYwQ1xcdThCRjdcXHU1MThEXFx1OEJENVxcdTRFMDBcXHU2QjIxXFx1MzAwMlwiKSB9KTtcbiAgICAgICAgICAgIExvZ2dlci5lcnJvcih7IG1lc3NhZ2U6IEpTT04uc3RyaW5naWZ5KGUpIH0pO1xuICAgICAgICB9XG4gICAgICAgIEFDRVYyTG9hZGVyLmRlc3Ryb3koKTtcbiAgICB9O1xuICAgIFBsdWdpblRvb2xraXQucHJvdG90eXBlLnVuaW5zdGFsbEJyaWRnZWRQbHVnaW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpbnN0YWxsZWRQbHVnaW5zID0gdGhpcy5nZXRJbnN0YWxsZWRQbHVnaW5zKCk7XG4gICAgICAgIHZhciBicmlkZ2VkUGx1Z2lucyA9IGluc3RhbGxlZFBsdWdpbnMuZmlsdGVyKGZ1bmN0aW9uIChpKSB7IHJldHVybiBpLm1hbmlmZXN0LmJyaWRnZWQgPT09IHRydWU7IH0pO1xuICAgICAgICBpZiAoYnJpZGdlZFBsdWdpbnMubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICB2YXIgaWRfMSA9IGJyaWRnZWRQbHVnaW5zWzBdLm1hbmlmZXN0LmlkO1xuICAgICAgICAgICAgaWYgKGlkXzEpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFsbGVkUGx1Z2luc18xID0gdGhpcy5nZXRJbnN0YWxsZWRQbHVnaW5zKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdJbnN0YWxsZWRQbHVnaW5zID0gaW5zdGFsbGVkUGx1Z2luc18xLmZpbHRlcihmdW5jdGlvbiAoaW5zdGFsbGVkUGx1Z2luKSB7IHJldHVybiBpbnN0YWxsZWRQbHVnaW4ubWFuaWZlc3QuaWQgIT09IGlkXzE7IH0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmVJbnN0YWxsZWRQbHVnaW5zKHsgaW5zdGFsbGVkUGx1Z2luczogbmV3SW5zdGFsbGVkUGx1Z2lucyB9KTtcbiAgICAgICAgICAgICAgICAgICAgTG9nZ2VyLnN1Y2Nlc3MoeyBtZXNzYWdlOiBJMThuLnQoeyBrZXk6ICd1bmluc3RhbGxlZC1icmlkZ2VkLXBsdWdpbicgfSkgKyBpZF8xIH0pO1xuICAgICAgICAgICAgICAgICAgICBBQ0VWMlRvYXN0LnNob3dUb2FzdCh7IHRleHQ6IEkxOG4udCh7IGtleTogJ3VuaW5zdGFsbGVkLWJyaWRnZWQtcGx1Z2luJyB9KSArIGlkXzEgKyBJMThuLnQoeyBrZXk6ICdwbGVhc2UtcmVsb2FkLXBhZ2UnIH0pIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBBQ0VWMlRvYXN0LnNob3dUb2FzdCh7IHRleHQ6IEkxOG4udCh7IGtleTogJ3VuaW5zdGFsbC1icmlkZ2VkLXBsdWdpbi1mYWlsZWQnIH0pICsgaWRfMSArIEkxOG4udCh7IGtleTogJ3BsZWFzZS10cnktYWdhaW4nIH0pIH0pO1xuICAgICAgICAgICAgICAgICAgICBMb2dnZXIuZXJyb3IoeyBtZXNzYWdlOiBKU09OLnN0cmluZ2lmeShlKSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFBsdWdpblRvb2xraXQucHJvdG90eXBlLmNoZWNrSWZJbnN0YWxsZWQgPSBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIHBsdWdpblBhY2sgPSBfYS5wbHVnaW5QYWNrO1xuICAgICAgICB2YXIgaW5zdGFsbGVkUGx1Z2lucyA9IHRoaXMuZ2V0SW5zdGFsbGVkUGx1Z2lucygpO1xuICAgICAgICB2YXIgaXNJbnN0YWxsZWQgPSBmYWxzZTtcbiAgICAgICAgaW5zdGFsbGVkUGx1Z2lucy5mb3JFYWNoKGZ1bmN0aW9uIChpbnN0YWxsZWRQbHVnaW4pIHtcbiAgICAgICAgICAgIGlmIChpbnN0YWxsZWRQbHVnaW4ubWFuaWZlc3QuaWQgPT09IHBsdWdpblBhY2subWFuaWZlc3QuaWQpIHtcbiAgICAgICAgICAgICAgICBpc0luc3RhbGxlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gaXNJbnN0YWxsZWQ7XG4gICAgfTtcbiAgICBQbHVnaW5Ub29sa2l0LnByb3RvdHlwZS5nZXRJbnN0YWxsZWRQbHVnaW5zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW5zdGFsbGVkUGx1Z2lucyA9IEFDRVYyU3RvcmFnZS5nZXRQbHVnaW5zKCk7XG4gICAgICAgIGlmICghaW5zdGFsbGVkUGx1Z2lucykge1xuICAgICAgICAgICAgaW5zdGFsbGVkUGx1Z2lucyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5zYXZlSW5zdGFsbGVkUGx1Z2lucyh7IGluc3RhbGxlZFBsdWdpbnM6IGluc3RhbGxlZFBsdWdpbnMgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGluc3RhbGxlZFBsdWdpbnM7XG4gICAgfTtcbiAgICBQbHVnaW5Ub29sa2l0LnByb3RvdHlwZS5zYXZlSW5zdGFsbGVkUGx1Z2lucyA9IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgaW5zdGFsbGVkUGx1Z2lucyA9IF9hLmluc3RhbGxlZFBsdWdpbnM7XG4gICAgICAgIEFDRVYyU3RvcmFnZS51cGRhdGVQbHVnaW5zU3RvcmFnZSh7IG5ld1BsdWdpbnM6IGluc3RhbGxlZFBsdWdpbnMgfSk7XG4gICAgfTtcbiAgICBQbHVnaW5Ub29sa2l0LnByb3RvdHlwZS5nZXRTZWxmUHJlZmVyZW5jZSA9IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgbWFuaWZlc3QgPSBfYS5tYW5pZmVzdDtcbiAgICAgICAgdmFyIGluc3RhbGxlZFBsdWdpbnMgPSB0aGlzLmdldEluc3RhbGxlZFBsdWdpbnMoKTtcbiAgICAgICAgdmFyIHRhcmdldFBsdWdpbiA9IGluc3RhbGxlZFBsdWdpbnMuZmluZChmdW5jdGlvbiAoaW5zdGFsbGVkUGx1Z2luKSB7IHJldHVybiBpbnN0YWxsZWRQbHVnaW4ubWFuaWZlc3QuaWQgPT09IG1hbmlmZXN0LmlkOyB9KTtcbiAgICAgICAgcmV0dXJuIHRhcmdldFBsdWdpbi5tYW5pZmVzdC5zZXR0aW5ncztcbiAgICB9O1xuICAgIFBsdWdpblRvb2xraXQucHJvdG90eXBlLnNhdmVTZWxmUHJlZmVyZW5jZSA9IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgbWFuaWZlc3QgPSBfYS5tYW5pZmVzdCwgc2V0dGluZ3MgPSBfYS5zZXR0aW5ncztcbiAgICAgICAgdmFyIGluc3RhbGxlZFBsdWdpbnMgPSB0aGlzLmdldEluc3RhbGxlZFBsdWdpbnMoKTtcbiAgICAgICAgdmFyIHRhcmdldFBsdWdpbiA9IGluc3RhbGxlZFBsdWdpbnMuZmluZChmdW5jdGlvbiAoaW5zdGFsbGVkUGx1Z2luKSB7IHJldHVybiBpbnN0YWxsZWRQbHVnaW4ubWFuaWZlc3QuaWQgPT09IG1hbmlmZXN0LmlkOyB9KTtcbiAgICAgICAgdGFyZ2V0UGx1Z2luLm1hbmlmZXN0LnNldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgICAgIHRoaXMuc2F2ZUluc3RhbGxlZFBsdWdpbnMoeyBpbnN0YWxsZWRQbHVnaW5zOiBpbnN0YWxsZWRQbHVnaW5zIH0pO1xuICAgIH07XG4gICAgUGx1Z2luVG9vbGtpdC5wcm90b3R5cGUuaW5pdGlhbGl6ZVBsdWdpbkV4ZWN1dGlvbkFuZFNldFRyaWdnZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpbnN0YWxsZWRQbHVnaW5zLCBfX3RvbWJzdG9uZXMsIF9sb29wXzEsIF9pLCBpbnN0YWxsZWRQbHVnaW5zXzIsIGluc3RhbGxlZFBsdWdpbjtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWRQbHVnaW5zID0gdGhpcy5nZXRJbnN0YWxsZWRQbHVnaW5zKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfX3RvbWJzdG9uZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnN0YWxsZWRQbHVnaW5zLmxlbmd0aCA9PT0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9vcF8xID0gZnVuY3Rpb24gKGluc3RhbGxlZFBsdWdpbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxmXzEsIG1hbmlmZXN0LCBhbGxBcGlzRGVmaW5lZCwgYXJncywgZmlsdGVyZWRBcmdzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaW5zdGFsbGVkUGx1Z2luLmVuYWJsZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBcImNvbnRpbnVlXCJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGZfMSA9IGluc3RhbGxlZFBsdWdpbi5zZWxmLCBtYW5pZmVzdCA9IGluc3RhbGxlZFBsdWdpbi5tYW5pZmVzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxBcGlzRGVmaW5lZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgUHJvbWlzZS5hbGwobWFuaWZlc3QucmVxdWVzdGVkQVBJcy5tYXAoZnVuY3Rpb24gKGFwaU5hbWUpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hcGlJbXBsZW1lbnRhdGlvbnNbYXBpTmFtZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHsgbmFtZTogYXBpTmFtZSwgdGFyZ2V0OiB0aGlzLmFwaUltcGxlbWVudGF0aW9uc1thcGlOYW1lXSB9XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvZ2dlci5lcnJvcih7IG1lc3NhZ2U6IFwiRXJyb3IgbG9hZGluZyBwbHVnaW4gdG9tYnN0b25lIFwiLmNvbmNhdChtYW5pZmVzdC5pZCwgXCIsIGNhbm5vdCByZXNvbHZlIEFQSSBcIikuY29uY2F0KGFwaU5hbWUsIFwiIG9mIHVuZGVmaW5lZC5cIikgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFDRVYyVG9hc3Quc2hvd1RvYXN0KHsgdGV4dDogXCJcXHU2M0QyXFx1NEVGNlxcdTMwMENcIi5jb25jYXQobWFuaWZlc3QuaWQsIFwiXFx1MzAwRFxcdThCRjdcXHU2QzQyXFx1NEU4NlxcdTRFMDBcXHU0RTJBXFx1NjcyQVxcdTVCOUFcXHU0RTQ5XFx1NzY4NEFQSVxcdTMwMENcIikuY29uY2F0KGFwaU5hbWUsIFwiXFx1MzAwRFxcdUZGMENcXHU1NkUwXFx1NkI2NFxcdTYyRDJcXHU3RUREXFx1OEY3RFxcdTUxNjVcXHU2QjY0XFx1NjNEMlxcdTRFRjZcXHUzMDAyXCIpIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxBcGlzRGVmaW5lZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgdW5kZWZpbmVkXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9KSldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3MgPSBfYi5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhbGxBcGlzRGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIFwiY29udGludWVcIl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWRBcmdzID0gYXJncy5maWx0ZXIoZnVuY3Rpb24gKGFyZykgeyByZXR1cm4gYXJnICE9PSB1bmRlZmluZWQ7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJlZEFyZ3MubGVuZ3RoID09PSBtYW5pZmVzdC5yZXF1ZXN0ZWRBUElzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX190b21ic3RvbmVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6IHNlbGZfMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW5pZmVzdDogbWFuaWZlc3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogZmlsdGVyZWRBcmdzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4ZWN1dGVkOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBMb2dnZXIuZXJyb3IoeyBtZXNzYWdlOiBcIkVycm9yIGNyZWF0aW5nIHBsdWdpbiB0b21ic3RvbmUgXCIuY29uY2F0KG1hbmlmZXN0LmlkLCBcIjogXCIpLmNvbmNhdChKU09OLnN0cmluZ2lmeShlcnJvcikpIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQUNFVjJEaWFsb2cuc2hvd0RpYWxvZyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IEkxOG4udCh7IGtleTogJ3JlcXVlc3QtcmVsb2FkJyB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBcIlxcdTYzRDJcXHU0RUY2XFx1OEY3RFxcdTUxNjVcXHU1NjY4XFx1NTcyOFxcdTc1MUZcXHU2MjEwXFx1NjNEMlxcdTRFRjZcXHUzMDBDXCIuY29uY2F0KG1hbmlmZXN0LmlkLCBcIlxcdTMwMERcXHU3Njg0XFx1NTg5M1xcdTc4OTFcXHU0RTJEXFx1NTFGQVxcdTczQjBcXHU5NTE5XFx1OEJFRlwiKS5jb25jYXQoZXJyb3IsIFwiXFx1RkYwQ1xcdTU2RTBcXHU2QjY0QWNGdW4gRXZvbHZlZFxcdTVERjJcXHU0RTJEXFx1NkI2MlxcdThGRDBcXHU4ODRDXFx1RkYwQ1xcdTYzMDlcXHU0RTBCXFx1MzAwQ1xcdTU5N0RcXHUzMDBEXFx1NEVFNVxcdTkxQ0RcXHU2NUIwXFx1NTQyRlxcdTUyQThBY0Z1biBFdm9sdmVkLlwiKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBva0FjdGlvbjogZnVuY3Rpb24gKCkgeyByZXR1cm4gbG9jYXRpb24ucmVsb2FkKCk7IH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pID0gMCwgaW5zdGFsbGVkUGx1Z2luc18yID0gaW5zdGFsbGVkUGx1Z2lucztcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoX2kgPCBpbnN0YWxsZWRQbHVnaW5zXzIubGVuZ3RoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YWxsZWRQbHVnaW4gPSBpbnN0YWxsZWRQbHVnaW5zXzJbX2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs1IC8qeWllbGQqKi8sIF9sb29wXzEoaW5zdGFsbGVkUGx1Z2luKV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgX2krKztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDFdO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvbWJzdG9uZXMgPSBfX3RvbWJzdG9uZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmZlcnJ5bWFuKCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgO1xuICAgIFBsdWdpblRvb2xraXQucHJvdG90eXBlLmZlcnJ5bWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZXhlY3V0ZVRvbWJzdG9uZXM7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZVRvbWJzdG9uZXMgPSBmdW5jdGlvbiAoX2EpIHsgcmV0dXJuIF9fYXdhaXRlcihfdGhpcywgW19hXSwgdm9pZCAwLCBmdW5jdGlvbiAoX2IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX190b21ic3RvbmVzLCBfaSwgX190b21ic3RvbmVzXzEsIHRvbWJzdG9uZSwgc2VsZl8yLCBhcmdzLCBtYW5pZmVzdCwgcmVxdWlyZWRQYXR0ZXJucywgaXNNYXRjaCwgdGFyZ2V0RnVuY3Rpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFVybCA9IF9iLmN1cnJlbnRVcmw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX3RvbWJzdG9uZXMgPSB0aGlzLnRvbWJzdG9uZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoX2kgPSAwLCBfX3RvbWJzdG9uZXNfMSA9IF9fdG9tYnN0b25lczsgX2kgPCBfX3RvbWJzdG9uZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbWJzdG9uZSA9IF9fdG9tYnN0b25lc18xW19pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b21ic3RvbmUuZXhlY3V0ZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmXzIgPSB0b21ic3RvbmUuc2VsZiwgYXJncyA9IHRvbWJzdG9uZS5hcmdzLCBtYW5pZmVzdCA9IHRvbWJzdG9uZS5tYW5pZmVzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYW5pZmVzdC50cmlnZ2VyLm1hdGNoZXMgJiYgbWFuaWZlc3QudHJpZ2dlci5tYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZFBhdHRlcm5zID0gbWFuaWZlc3QudHJpZ2dlci5tYXRjaGVzLmZsYXRNYXAoZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gcGFnZUxpc3Rba2V5XSB8fCBbXTsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNNYXRjaCA9IHJlcXVpcmVkUGF0dGVybnMuc29tZShmdW5jdGlvbiAocGF0dGVybikgeyByZXR1cm4gcGF0dGVybi50ZXN0KGN1cnJlbnRVcmwpOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNNYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9nZ2VyLmluZm8oeyBtZXNzYWdlOiBcImV4ZWN1dGVkIFwiLmNvbmNhdChtYW5pZmVzdC5pZCkgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRGdW5jdGlvbiA9IG5ldyAoRnVuY3Rpb24uYmluZC5hcHBseShGdW5jdGlvbiwgX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFt2b2lkIDBdLCBhcmdzLm1hcChmdW5jdGlvbiAoYXJnKSB7IHJldHVybiBhcmcubmFtZTsgfSksIGZhbHNlKSwgWydtYW5pZmVzdCcsICdnZXRTZWxmUHJlZmVyZW5jZScsIHNlbGZfMl0sIGZhbHNlKSkpKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zdCB0YXJnZXRGdW5jdGlvbiA9IG5ldyBGdW5jdGlvbiguLi5hcmdzLm1hcCgoYXJnOiBhbnkpID0+IGFyZy5uYW1lKSwgJ21hbmlmZXN0JywgYCgoKT0+e1widXNlIHN0cmljdFwiOyhhc3luYygpPT57Y29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0tLS0nKX0pKCk7YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRGdW5jdGlvbi5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoX19zcHJlYWRBcnJheShbXSwgYXJncy5tYXAoZnVuY3Rpb24gKGFyZykgeyByZXR1cm4gYXJnLnRhcmdldDsgfSksIGZhbHNlKSwgW21hbmlmZXN0LCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hbmlmZXN0ID0gX2EubWFuaWZlc3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5nZXRTZWxmUHJlZmVyZW5jZSh7IG1hbmlmZXN0OiBtYW5pZmVzdCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XSwgZmFsc2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvbWJzdG9uZS5leGVjdXRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvZ2dlci5lcnJvcih7IG1lc3NhZ2U6IFwiRXJyb3IgZmVycnlpbmcgcGx1Z2luIFwiLmNvbmNhdChtYW5pZmVzdC5pZCwgXCI6IFwiKS5jb25jYXQoSlNPTi5zdHJpbmdpZnkoZSkpIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQUNFVjJUb2FzdC5zaG93VG9hc3QoeyB0ZXh0OiBcIlxcdTY0NDZcXHU2RTIxXFx1NEVCQVxcdTU3MjhcXHU2MjY3XFx1ODg0Q1xcdTYzRDJcXHU0RUY2XFx1MzAwQ1wiLmNvbmNhdChtYW5pZmVzdC5pZCwgXCJcXHUzMDBEXFx1NEUyRFxcdTUxRkFcXHU3M0IwXFx1OTUxOVxcdThCRUZcIikuY29uY2F0KEpTT04uc3RyaW5naWZ5KGUpLCBcIlxcdUZGMENcXHU1NkUwXFx1NkI2NFxcdTVERjJcXHU0RTJEXFx1NkI2MlxcdThGRDBcXHU4ODRDXFx1NkI2NFxcdTYzRDJcXHU0RUY2XFx1MzAwMlwiKSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvbWJzdG9uZXMgPSBfX3RvbWJzdG9uZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pOyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgZXhlY3V0ZVRvbWJzdG9uZXMoeyBjdXJyZW50VXJsOiB3aW5kb3cubG9jYXRpb24uaHJlZiB9KV07XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFN1cGVydmlzb3IudXJsQ2hhbmdlKGZ1bmN0aW9uIChjdXJyZW50VXJsKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIGV4ZWN1dGVUb21ic3RvbmVzKHsgY3VycmVudFVybDogY3VycmVudFVybCB9KV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7IH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIDtcbiAgICBQbHVnaW5Ub29sa2l0LnByb3RvdHlwZS53YWtlVXBCdWlsZEluUGx1Z2lucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKFByZWZlcmVuY2VzLmdldFByZWZlcmVuY2UoeyBjYXRlZ29yeTogJ2RldmVsb3BlcicsIGs6ICdwc3YnIH0pICE9PSAnZnVsbCcpIHtcbiAgICAgICAgICAgIERlYnVnQnJpZGdlLndha2VVcCgpO1xuICAgICAgICB9XG4gICAgICAgIFBsdWdpblN0b3JlLndha2VVcCgpO1xuICAgIH07XG4gICAgUGx1Z2luVG9vbGtpdC5wcm90b3R5cGUuZXh0cmFjdEFuZEluc3RhbGxQbHVnaW4gPSBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNvbXByZXNzZWREYXRhID0gX2EuY29tcHJlc3NlZERhdGE7XG4gICAgICAgIEFDRVYyRGlhbG9nLnNob3dEaWFsb2coe1xuICAgICAgICAgICAgdGl0bGU6IEkxOG4udCh7IGtleTogSTE4bi50KHsga2V5OiAnd2FudHMtdG8tZXh0cmFjdC1hbmQtaW5zdGFsbC1wbHVnaW4tcGFja2FnZScgfSkgfSksXG4gICAgICAgICAgICBjb250ZW50OiBJMThuLnQoeyBrZXk6ICdkby15b3UtcmVhbGx5LXdhbnQtdG8tZG8tdGhhdCcgfSksXG4gICAgICAgICAgICBva0FjdGlvbjogZnVuY3Rpb24gKCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWNvbXByZXNzZWRBcnJheUJ1ZmZlciwgZmlsZXMsIHJhd09iamVjdCwgcGFjaywgZXJyXzE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQUNFVjJMb2FkZXIuZHJhdygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDMsICwgNF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY29tcHJlc3NlZEFycmF5QnVmZmVyID0gcGFrby5pbmZsYXRlKG5ldyBVaW50OEFycmF5KGNvbXByZXNzZWREYXRhKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkZWNvbXByZXNzZWRBcnJheUJ1ZmZlci5idWZmZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQUNFVjJUb2FzdC5zaG93VG9hc3QoeyB0ZXh0OiBJMThuLnQoeyBrZXk6ICdkZWNvbXByZXNzZWQtZGF0YS1kb2VzLW5vdC1jb250YWluLXZhbGlkLWJ1ZmZlci1wcm9wZXJ0eScgfSkgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZXMgPSB1bnRhcihkZWNvbXByZXNzZWRBcnJheUJ1ZmZlci5idWZmZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZmlsZXMgfHwgZmlsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFDRVYyVG9hc3Quc2hvd1RvYXN0KHsgdGV4dDogSTE4bi50KHsga2V5OiAnbm8tZmlsZXMtZXh0cmFjdGVkLWZyb20tdGhlLWNvbXByZXNzZWQtZGF0YScgfSkgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmF3T2JqZWN0ID0gZmlsZXNbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmF3T2JqZWN0ID0gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKHJhd09iamVjdC5maWxlRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFjayA9IEpTT04ucGFyc2UocmF3T2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLmluc3RhbGxQbHVnaW4oeyBwbHVnaW5QYWNrOiBwYWNrLCBicmlkZ2VkOiBmYWxzZSB9KV07XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycl8xID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvZ2dlci5lcnJvcih7IG1lc3NhZ2U6IFwiRXJyb3IgZXh0cmFjdGluZyBhbmQgaW5zdGFsbGluZyBwbHVnaW4gcGFja2FnZTogXCIuY29uY2F0KEpTT04uc3RyaW5naWZ5KGVycl8xKSkgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQUNFVjJUb2FzdC5zaG93VG9hc3QoeyB0ZXh0OiBJMThuLnQoeyBrZXk6ICdlcnJvci1leHRyYWN0aW5nLWFuZC1pbnN0YWxsaW5nLXBsdWdpbi1wYWNrYWdlJyB9KSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBQ0VWMkxvYWRlci5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTsgfSxcbiAgICAgICAgICAgIGNhbmNlbEFjdGlvbjogZnVuY3Rpb24gKCkgeyByZXR1cm4gQUNFVjJUb2FzdC5zaG93VG9hc3QoeyB0ZXh0OiAnY2FuY2VsZWQnIH0pOyB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgO1xuICAgIFBsdWdpblRvb2xraXQucHJvdG90eXBlLmRvd25sb2FkQW5kSW5zdGFsbFBsdWdpblBhY2sgPSBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCBhcmd1bWVudHMsIHZvaWQgMCwgZnVuY3Rpb24gKF9iKSB7XG4gICAgICAgICAgICB2YXIgZnVsbERvd25sb2FkVXJsO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciBtYW5pZmVzdCA9IF9iLm1hbmlmZXN0O1xuICAgICAgICAgICAgcmV0dXJuIF9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYykge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2MubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBWYXJpYWJsZS5wbHVnaW5Eb3dubG9hZFVSTChiaWdNYW5pZmVzdCldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICBmdWxsRG93bmxvYWRVcmwgPSBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBvcGVuRGlhbG9nKFwiQWNGdW4gRXZvbHZlZCBSdW50aW1lIFxcdTg5ODFcXHU1Qjg5XFx1ODhDNSBcXHUzMDBDXCIuY29uY2F0KGJpZ01hbmlmZXN0LmlkLm9yaWdpbmFsLCBcIlxcdTMwMEQgXCIpLCBcIkFjRnVuIEV2b2x2ZWQgUnVudGltZSBcXHU4OTgxXFx1NEVDRSBcXHUzMDBDXCIuY29uY2F0KGZ1bGxEb3dubG9hZFVybCwgXCJcXHUzMDBEIFxcdTRFMEJcXHU4RjdEIFxcdTMwMENcIikuY29uY2F0KGJpZ01hbmlmZXN0LmlkLm9yaWdpbmFsLCBcIlxcdTMwMEQgXFx1NzEzNlxcdTU0MEVcXHU1Qjg5XFx1ODhDNVxcdUZGMENcXHU2QjY0XFx1OTRGRVxcdTYzQTVcXHVGRjFBXCIpLmNvbmNhdChpc1RydXN0YWJsZShmdWxsRG93bmxvYWRVcmwpID8gJ+WPl+S/oeS7uycgOiAn5LiN5Y+X5L+h5Lu7JyksIGZhbHNlLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfX2F3YWl0ZXIoX3RoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2FkZXJEYXRhLCBjb21wcmVzc2VkUGFjaywgZGVjb21wcmVzc2VkQ29udGVudCwgZmlsZXMsIHJhd09iamVjdCwgcGFjaywgZXJyXzI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIGFkZExvYWRlcihsb2FkZXJBY2VVdWlkKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZXJEYXRhID0gX2Euc2VudCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBtb25rZXkoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBmdWxsRG93bmxvYWRVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiAnYXJyYXlidWZmZXInXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wcmVzc2VkUGFjayA9IF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2EudHJ5cy5wdXNoKFszLCA1LCAsIDddKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVjb21wcmVzc2VkQ29udGVudCA9IHBha28uaW5mbGF0ZShjb21wcmVzc2VkUGFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzID0gdW50YXIoZGVjb21wcmVzc2VkQ29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhd09iamVjdCA9IGZpbGVzWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYXdPYmplY3QgPSBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUocmF3T2JqZWN0LmZpbGVEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFjayA9IEpTT04ucGFyc2UocmF3T2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgaW5zdGFsbFBsdWdpbihwYWNrKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyXzIgPSBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+ino+WOi+e8qeWksei0pScsIGVycl8yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgb3BlbkRpYWxvZygn5o+S5Lu25a6J6KOF5Zmo5peg5rOV6Kej5Y6L57ypJywgXCJcXHU2M0QyXFx1NEVGNlxcdTMwMENcIi5jb25jYXQoYmlnTWFuaWZlc3QuaWQub3JpZ2luYWwsIFwiXFx1MzAwRFxcdTc2ODRcXHU1Qjg5XFx1ODhDNVxcdTY1RTBcXHU2Q0Q1XFx1NUI4Q1xcdTYyMTBcXHVGRjBDXFx1NTZFMFxcdTRFM0FcXHU2M0QyXFx1NEVGNlxcdTVCODlcXHU4OEM1XFx1NTY2OFxcdTY1RTBcXHU2Q0Q1XFx1NjIxMFxcdTUyOUZcXHU4OUUzXFx1NTM4QlxcdTdGMjlcXHVGRjBDXFx1OEJGN1xcdTUxOERcXHU4QkQ1XFx1NEUwMFxcdTZCMjFcXHUzMDAyXCIpLCB0cnVlLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDddO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzogcmV0dXJuIFs0IC8qeWllbGQqLywgcmVtb3ZlTG9hZGVyKGxvYWRlckRhdGEpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9hLmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiByZXR1cm4gWzQgLyp5aWVsZCovLCBvcGVuRGlhbG9nKCfmj5Lku7blronoo4Xooqvlj5bmtognLCBcIlxcdTYzRDJcXHU0RUY2XFx1MzAwQ1wiLmNvbmNhdChiaWdNYW5pZmVzdC5pZC5vcmlnaW5hbCwgXCJcXHUzMDBEXFx1NzY4NFxcdTVCODlcXHU4OEM1XFx1ODhBQlxcdTUzRDZcXHU2RDg4XFx1MzAwMlwiKSwgdHJ1ZSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hLnNlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgfSldO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICBfYy5zZW50KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFBsdWdpblRvb2xraXQ7XG59KCkpO1xuZXhwb3J0IGRlZmF1bHQgbmV3IFBsdWdpblRvb2xraXQoKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/core/api/PluginToolkit.ts\n");

/***/ }),

/***/ "./src/core/api/Variable.ts":
/*!**********************************!*\
  !*** ./src/core/api/Variable.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _Version__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Version */ \"./src/core/api/Version.ts\");\n/* harmony import */ var _Preferences__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Preferences */ \"./src/core/api/Preferences.ts\");\n/* harmony import */ var _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugins/ACEV2Toast */ \"./src/plugins/ACEV2Toast.ts\");\n/* harmony import */ var _I18n__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./I18n */ \"./src/core/api/I18n.ts\");\n\n\n\n\nvar Variable = /** @class */ (function () {\n    function Variable() {\n        this.ANIMATION_DURATION = 1000 * .2;\n        this.TOAST_DURATION = 1000 * 2;\n        this.DEBOUNCE_DURATION = 1000 * .5;\n        this.MASTER_MANIFEST = {\n            icon: \"\",\n            name: 'RuntimeCalled',\n            id: '@wenzi7777/acev2_runtime',\n            versions: [_Version__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getFullVersion()],\n            description: 'AcFun Evolved Runtime V2.',\n            createdAt: new Date('2024-08-09').getTime() + '',\n            updatedAt: new Date().getTime() + '',\n            author: 'wenzi7777',\n            copyright: '(c)2024 wenzi7777, licensed under the MIT License.',\n            requestedAPIs: [],\n            website: 'https://acev2.1205.moe/',\n            trigger: {\n                receiveHandler: true,\n                matches: ['*']\n            },\n            settings: []\n        };\n        this.PUBLIC_KEY = \"-----BEGIN PUBLIC KEY-----\\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAilgGwC2CNm3zSSUzaz7j\\ncIM08uKKGGmWs1yoQNUzBsgX/cnuVQsuPL79RDtt5P8/aPwKyzFKcd2kxIzKbLr/\\nXTOhPz6miVcRd86HiFJmEC1zO/9FQITMNcN4/xjGGnKZWa80su7CpFdHkTLifLiO\\nP2U7qi/yiNOrjEfo4ymCjFToFBYQ2VQ6Te5mnQxvmK9arKwm/wT40OPk9H8YpJnx\\nZiPLyCCYhzOQCHHijlc/iI2oNw0UnqLJ4wDsBSnuePC9QWyz3QdV+o//AVZpjGq6\\nXWWtEOgGfY5nyOSzp19FbiVgbxV3QX8RWBP3ifPtJhv0D16X1joCELgnqtKbaVkG\\nL6+m0r+YSoZojY2HY0159PafKkYg5xhTTCLyXtsWscEFd/PK2sm4Ag/htuGYEX2n\\nHH9XGyi1oV/8zeFF4YKe5DlEyxy5KaBnRBGyo4YSfDZD4+PGTponUOaJc1iC/qPu\\nYnCFobD55bs2zlDWpJUNLaUIkijFWMwNbtqlRGp5wUnNrFdv8k6L2vR9fUnetxoO\\nxowBvt/quZbgpn5K/WVF8QML3dY4clPDGYvYceKPGVCdZUI+NTnfeeH45ldOYSin\\n3z+cDYEA7wQaPtu57mRRQOBVUaa5tCP43OJHtlsFjKJmvx4Iw2Z4OEUZZJThZcJG\\nyl8yJuhgZ/FJ6NU5dSVzRjkCAwEAAQ==\\n-----END PUBLIC KEY-----\";\n        this.PAGE_SIZE = 8;\n    }\n    Variable.prototype.basePluginRepoURL = function () {\n        var source = _Preferences__WEBPACK_IMPORTED_MODULE_1__[\"default\"].getPreference({ category: 'general', k: 'source' });\n        if (source === 'github') {\n            return 'https://raw.githubusercontent.com/wenzi7777/acev2_plugins/main/';\n        }\n        else if (source === 'cloudflare') {\n            return 'https://acev2-plugins.1205.moe';\n        }\n        else if (source === 'jsdelivr') {\n            return 'https://cdn.jsdelivr.net/gh/wenzi7777/acev2_plugins/@main/';\n        }\n        else {\n            _plugins_ACEV2Toast__WEBPACK_IMPORTED_MODULE_2__[\"default\"].showToast({ text: _I18n__WEBPACK_IMPORTED_MODULE_3__[\"default\"].t({ key: 'invalid-source-please-select-again' }) });\n        }\n    };\n    Variable.prototype.bigManifestURL = function () {\n        return this.basePluginRepoURL() + 'bigManifest.json';\n    };\n    Variable.prototype.developerKitURL = function () {\n        return this.basePluginRepoURL() + 'developer-kit.zip';\n    };\n    Variable.prototype.pluginDownloadURL = function (_a) {\n        var manifest = _a.manifest;\n        return \"\".concat(this.basePluginRepoURL());\n    };\n    return Variable;\n}());\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new Variable());\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29yZS9hcGkvVmFyaWFibGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBZ0M7QUFDUTtBQUNVO0FBQ3hCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixnREFBTztBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsb0RBQVcsaUJBQWlCLGtDQUFrQztBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksMkRBQVUsYUFBYSxNQUFNLDZDQUFJLEtBQUssMkNBQTJDLEdBQUc7QUFDaEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsaUVBQWUsY0FBYyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWNmdW5fZXZvbHZlZC8uL3NyYy9jb3JlL2FwaS9WYXJpYWJsZS50cz8yMjVhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBWZXJzaW9uIGZyb20gXCIuL1ZlcnNpb25cIjtcbmltcG9ydCBQcmVmZXJlbmNlcyBmcm9tIFwiLi9QcmVmZXJlbmNlc1wiO1xuaW1wb3J0IEFDRVYyVG9hc3QgZnJvbSBcIi4uLy4uL3BsdWdpbnMvQUNFVjJUb2FzdFwiO1xuaW1wb3J0IEkxOG4gZnJvbSBcIi4vSTE4blwiO1xudmFyIFZhcmlhYmxlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFZhcmlhYmxlKCkge1xuICAgICAgICB0aGlzLkFOSU1BVElPTl9EVVJBVElPTiA9IDEwMDAgKiAuMjtcbiAgICAgICAgdGhpcy5UT0FTVF9EVVJBVElPTiA9IDEwMDAgKiAyO1xuICAgICAgICB0aGlzLkRFQk9VTkNFX0RVUkFUSU9OID0gMTAwMCAqIC41O1xuICAgICAgICB0aGlzLk1BU1RFUl9NQU5JRkVTVCA9IHtcbiAgICAgICAgICAgIGljb246IFwiXCIsXG4gICAgICAgICAgICBuYW1lOiAnUnVudGltZUNhbGxlZCcsXG4gICAgICAgICAgICBpZDogJ0B3ZW56aTc3NzcvYWNldjJfcnVudGltZScsXG4gICAgICAgICAgICB2ZXJzaW9uczogW1ZlcnNpb24uZ2V0RnVsbFZlcnNpb24oKV0sXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0FjRnVuIEV2b2x2ZWQgUnVudGltZSBWMi4nLFxuICAgICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgnMjAyNC0wOC0wOScpLmdldFRpbWUoKSArICcnLFxuICAgICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLmdldFRpbWUoKSArICcnLFxuICAgICAgICAgICAgYXV0aG9yOiAnd2Vuemk3Nzc3JyxcbiAgICAgICAgICAgIGNvcHlyaWdodDogJyhjKTIwMjQgd2Vuemk3Nzc3LCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuJyxcbiAgICAgICAgICAgIHJlcXVlc3RlZEFQSXM6IFtdLFxuICAgICAgICAgICAgd2Vic2l0ZTogJ2h0dHBzOi8vYWNldjIuMTIwNS5tb2UvJyxcbiAgICAgICAgICAgIHRyaWdnZXI6IHtcbiAgICAgICAgICAgICAgICByZWNlaXZlSGFuZGxlcjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBtYXRjaGVzOiBbJyonXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldHRpbmdzOiBbXVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLlBVQkxJQ19LRVkgPSBcIi0tLS0tQkVHSU4gUFVCTElDIEtFWS0tLS0tXFxuTUlJQ0lqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FnOEFNSUlDQ2dLQ0FnRUFpbGdHd0MyQ05tM3pTU1V6YXo3alxcbmNJTTA4dUtLR0dtV3MxeW9RTlV6QnNnWC9jbnVWUXN1UEw3OVJEdHQ1UDgvYVB3S3l6RktjZDJreEl6S2JMci9cXG5YVE9oUHo2bWlWY1JkODZIaUZKbUVDMXpPLzlGUUlUTU5jTjQveGpHR25LWldhODBzdTdDcEZkSGtUTGlmTGlPXFxuUDJVN3FpL3lpTk9yakVmbzR5bUNqRlRvRkJZUTJWUTZUZTVtblF4dm1LOWFyS3dtL3dUNDBPUGs5SDhZcEpueFxcblppUEx5Q0NZaHpPUUNISGlqbGMvaUkyb053MFVucUxKNHdEc0JTbnVlUEM5UVd5ejNRZFYrby8vQVZacGpHcTZcXG5YV1d0RU9nR2ZZNW55T1N6cDE5RmJpVmdieFYzUVg4UldCUDNpZlB0Smh2MEQxNlgxam9DRUxnbnF0S2JhVmtHXFxuTDYrbTByK1lTb1pvalkySFkwMTU5UGFmS2tZZzV4aFRUQ0x5WHRzV3NjRUZkL1BLMnNtNEFnL2h0dUdZRVgyblxcbkhIOVhHeWkxb1YvOHplRkY0WUtlNURsRXl4eTVLYUJuUkJHeW80WVNmRFpENCtQR1Rwb25VT2FKYzFpQy9xUHVcXG5ZbkNGb2JENTViczJ6bERXcEpVTkxhVUlraWpGV013TmJ0cWxSR3A1d1VuTnJGZHY4azZMMnZSOWZVbmV0eG9PXFxueG93QnZ0L3F1WmJncG41Sy9XVkY4UU1MM2RZNGNsUERHWXZZY2VLUEdWQ2RaVUkrTlRuZmVlSDQ1bGRPWVNpblxcbjN6K2NEWUVBN3dRYVB0dTU3bVJSUU9CVlVhYTV0Q1A0M09KSHRsc0ZqS0ptdng0SXcyWjRPRVVaWkpUaFpjSkdcXG55bDh5SnVoZ1ovRko2TlU1ZFNWelJqa0NBd0VBQVE9PVxcbi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLVwiO1xuICAgICAgICB0aGlzLlBBR0VfU0laRSA9IDg7XG4gICAgfVxuICAgIFZhcmlhYmxlLnByb3RvdHlwZS5iYXNlUGx1Z2luUmVwb1VSTCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IFByZWZlcmVuY2VzLmdldFByZWZlcmVuY2UoeyBjYXRlZ29yeTogJ2dlbmVyYWwnLCBrOiAnc291cmNlJyB9KTtcbiAgICAgICAgaWYgKHNvdXJjZSA9PT0gJ2dpdGh1YicpIHtcbiAgICAgICAgICAgIHJldHVybiAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3dlbnppNzc3Ny9hY2V2Ml9wbHVnaW5zL21haW4vJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzb3VyY2UgPT09ICdjbG91ZGZsYXJlJykge1xuICAgICAgICAgICAgcmV0dXJuICdodHRwczovL2FjZXYyLXBsdWdpbnMuMTIwNS5tb2UnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHNvdXJjZSA9PT0gJ2pzZGVsaXZyJykge1xuICAgICAgICAgICAgcmV0dXJuICdodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvZ2gvd2Vuemk3Nzc3L2FjZXYyX3BsdWdpbnMvQG1haW4vJztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIEFDRVYyVG9hc3Quc2hvd1RvYXN0KHsgdGV4dDogSTE4bi50KHsga2V5OiAnaW52YWxpZC1zb3VyY2UtcGxlYXNlLXNlbGVjdC1hZ2FpbicgfSkgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZhcmlhYmxlLnByb3RvdHlwZS5iaWdNYW5pZmVzdFVSTCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZVBsdWdpblJlcG9VUkwoKSArICdiaWdNYW5pZmVzdC5qc29uJztcbiAgICB9O1xuICAgIFZhcmlhYmxlLnByb3RvdHlwZS5kZXZlbG9wZXJLaXRVUkwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJhc2VQbHVnaW5SZXBvVVJMKCkgKyAnZGV2ZWxvcGVyLWtpdC56aXAnO1xuICAgIH07XG4gICAgVmFyaWFibGUucHJvdG90eXBlLnBsdWdpbkRvd25sb2FkVVJMID0gZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHZhciBtYW5pZmVzdCA9IF9hLm1hbmlmZXN0O1xuICAgICAgICByZXR1cm4gXCJcIi5jb25jYXQodGhpcy5iYXNlUGx1Z2luUmVwb1VSTCgpKTtcbiAgICB9O1xuICAgIHJldHVybiBWYXJpYWJsZTtcbn0oKSk7XG5leHBvcnQgZGVmYXVsdCBuZXcgVmFyaWFibGUoKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/core/api/Variable.ts\n");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("17cedca1b5a0860e193b")
/******/ })();
/******/ 
/******/ }
);